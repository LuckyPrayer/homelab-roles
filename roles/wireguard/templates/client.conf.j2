# WireGuard Client Configuration
# Generated by Ansible - Do not edit manually
# Host: {{ inventory_hostname }}
# Mode: Client

[Interface]
# Client private key (keep secret!)
PrivateKey = {{ wireguard_client_private_key }}

# Client address in the VPN network
Address = {{ wireguard_client_address }}

{% if wireguard_mtu is defined and wireguard_mtu %}
# MTU for the interface
MTU = {{ wireguard_mtu }}
{% endif %}

{% if wireguard_dns | default([]) | length > 0 %}
# DNS servers
DNS = {{ wireguard_dns | join(', ') }}
{% endif %}

# PostUp: Commands to run after interface comes up
{% for cmd in wireguard_post_up | default([]) %}
PostUp = {{ cmd }}
{% endfor %}

# PostDown: Commands to run after interface goes down
{% for cmd in wireguard_post_down | default([]) %}
PostDown = {{ cmd }}
{% endfor %}

# ============================================================
# Server Peer (pharos VPS)
# ============================================================
[Peer]
# Server public key
PublicKey = {{ wireguard_server_public_key }}

{% if wireguard_preshared_key is defined and wireguard_preshared_key | length > 0 %}
# Preshared key for additional security
PresharedKey = {{ wireguard_preshared_key }}
{% endif %}

# Server endpoint (public IP:port)
Endpoint = {{ wireguard_server_endpoint }}

# Networks to route through the tunnel
# This typically includes the WireGuard network so we can reach the server
AllowedIPs = {{ wireguard_client_allowed_ips }}

# Persistent keepalive to maintain connection through NAT/firewall
# Essential for home networks behind NAT
PersistentKeepalive = {{ wireguard_persistent_keepalive }}
